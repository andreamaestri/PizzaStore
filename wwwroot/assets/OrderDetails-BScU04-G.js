import{i as D,j as r,aH as k,e as B,r as p,B as t,w,A as f,h as i,T as a,I as P,D as g,f as z,aI as L,aJ as R,H as A,R as N}from"./index-qK0o-Q92.js";import{u as S}from"./useOrderData-8jWyn2bF.js";import{B as E,L as y}from"./Link-CdVe1SFP.js";import{C as v}from"./Chip-3VK4x1wM.js";import{G as c}from"./Grid-CMQ_ztod.js";import{C as F,a as H}from"./CardContent-BUZoHmbS.js";const l=D(r.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),J=()=>{var m;const{id:x}=k(),d=B(),{fetchOrderById:h,loading:C,error:u,updateOrderStatus:I}=S(),[s,j]=p.useState(null);p.useEffect(()=>{(async()=>{const n=await h(Number.parseInt(x));j(n)})()},[x,h]);const b=e=>{switch(e){case"Delivered":return"success";case"Ready":return"warning";case"InProgress":return"primary";case"Cancelled":return"error";default:return"default"}},o=async e=>{const n=await I(s.id,e);n&&j(n)},O=e=>new Date(e).toLocaleString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return C?r.jsx(t,{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh",children:r.jsx(w,{})}):u?r.jsxs(t,{p:3,children:[r.jsxs(f,{severity:"error",children:["Error loading order: ",u.message]}),r.jsx(i,{startIcon:r.jsx(l,{}),onClick:()=>d("/orders"),sx:{mt:2},children:"Back to Orders"})]}):s?r.jsxs(t,{p:3,children:[r.jsxs(E,{sx:{mb:3},children:[r.jsx(y,{color:"inherit",href:"#",onClick:e=>{e.preventDefault(),d("/")},children:"Dashboard"}),r.jsx(y,{color:"inherit",href:"#",onClick:e=>{e.preventDefault(),d("/orders")},children:"Orders"}),r.jsxs(a,{color:"text.primary",children:["Order #",s.id]})]}),r.jsxs(t,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexWrap:"wrap",gap:2,children:[r.jsxs(t,{display:"flex",alignItems:"center",children:[r.jsx(P,{sx:{mr:1},onClick:()=>d("/orders"),children:r.jsx(l,{})}),r.jsxs(a,{variant:"h5",component:"h1",children:["Order #",s.id]}),r.jsx(v,{label:s.status,color:b(s.status),sx:{ml:2}})]}),r.jsx(t,{children:s.status!=="Delivered"&&s.status!=="Cancelled"&&r.jsxs(r.Fragment,{children:[s.status==="InProgress"&&r.jsx(i,{variant:"contained",color:"warning",onClick:()=>o("Ready"),sx:{mr:1},children:"Mark as Ready"}),s.status==="Ready"&&r.jsx(i,{variant:"contained",color:"success",onClick:()=>o("Delivered"),sx:{mr:1},children:"Mark as Delivered"}),r.jsx(i,{variant:"outlined",color:"error",onClick:()=>o("Cancelled"),children:"Cancel Order"})]})})]}),r.jsxs(c,{container:!0,spacing:3,children:[r.jsx(c,{item:!0,xs:12,md:4,children:r.jsx(F,{variant:"outlined",sx:{mb:3},children:r.jsxs(H,{children:[r.jsx(a,{variant:"h6",gutterBottom:!0,children:"Customer Information"}),r.jsx(g,{sx:{mb:2}}),r.jsxs(a,{variant:"body1",gutterBottom:!0,children:[r.jsx("strong",{children:"Name:"})," ",s.customerName]}),r.jsxs(a,{variant:"body1",gutterBottom:!0,children:[r.jsx("strong",{children:"Address:"})," ",s.address||"N/A"]}),r.jsxs(a,{variant:"body1",children:[r.jsx("strong",{children:"Order Date:"})," ",O(s.orderDate)]})]})})}),r.jsxs(c,{item:!0,xs:12,md:8,children:[r.jsxs(z,{variant:"outlined",sx:{mb:3},children:[r.jsx(t,{p:2,pb:1,children:r.jsx(a,{variant:"h6",children:"Order Items"})}),r.jsx(g,{}),r.jsx(L,{children:(m=s.items)==null?void 0:m.map((e,n)=>r.jsx(R,{secondaryAction:r.jsxs(a,{variant:"body1",fontWeight:"bold",children:["£",(e.unitPrice*e.quantity).toFixed(2)]}),divider:n<s.items.length-1,children:r.jsx(A,{primary:r.jsxs(t,{display:"flex",alignItems:"center",children:[r.jsx(a,{variant:"body1",children:e.pizzaName||`Pizza #${e.pizzaId}`}),r.jsx(v,{label:`x${e.quantity}`,size:"small",sx:{ml:1}})]}),secondary:`£${e.unitPrice.toFixed(2)} each`})},e.id))}),r.jsxs(t,{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",sx:{backgroundColor:e=>e.palette.mode==="dark"?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.03)"},children:[r.jsx(a,{variant:"h6",children:"Total"}),r.jsxs(a,{variant:"h6",color:"primary",children:["£",s.totalAmount.toFixed(2)]})]})]}),r.jsx(t,{display:"flex",justifyContent:"flex-end",children:r.jsx(i,{startIcon:r.jsx(N,{}),variant:"outlined",children:"Print Receipt"})})]})]})]}):r.jsxs(t,{p:3,children:[r.jsx(f,{severity:"info",children:"Order not found."}),r.jsx(i,{startIcon:r.jsx(l,{}),onClick:()=>d("/orders"),sx:{mt:2},children:"Back to Orders"})]})};export{J as default};
